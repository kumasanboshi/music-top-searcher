# エスカレーションガイド

判断に迷う場合は早めに人間に委譲し、無駄な試行錯誤を防止します。

## 基本原則

**「客観的判定不可」が最優先判定基準**

技術的に解決可能な問題は自力で解決し、ビジネス判断や仕様の曖昧さがある場合のみエスカレーションする。

## 即座にエスカレーションすべき状況

### 1. 仕様の曖昧さ
- [ ] 複数の解釈が可能な要件
- [ ] 既存コードと矛盾する要件
- [ ] Requirements.md に記載がない仕様

### 2. 設計に関わる判断
- [ ] アーキテクチャレベルの変更
- [ ] データベーススキーマの変更
- [ ] 新規ライブラリ/依存関係の追加
- [ ] 型システムの大幅な変更

### 3. ビジネス判断が必要
- [ ] 複数の技術的に妥当な解決策があり、ビジネス価値が異なる
- [ ] 外部システムの期待値が不明
- [ ] ユーザー体験に直接影響する判断

### 4. セキュリティ・リスク
- [ ] 認証・認可に関わる変更
- [ ] APIキーやシークレットの扱い
- [ ] データの永続化方法の変更

### 5. 前例のない状況
- [ ] 既存コードにパターンがない
- [ ] Claude.md/Requirements.md に指針がない
- [ ] 過去のコミット履歴に類似例がない

## エスカレーション不要（自力で解決）

### 技術的に解決可能
- [ ] 型エラーの修正
- [ ] テスト失敗の修正（仕様が明確な場合）
- [ ] フォーマット・リント修正
- [ ] 明確なバグの修正

### 既存パターンに従う
- [ ] 既存コードと同様のパターンで実装
- [ ] Claude.md のコーディング規約に沿った修正
- [ ] 型定義の追加（推論可能な場合）

## エスカレーションの形式

```markdown
## 判断を仰ぎたい点があります

### 状況
[現状の説明]

### 問題点
[なぜ判断が必要か]

### 選択肢

**選択肢A**: [内容]
- メリット: ...
- デメリット: ...

**選択肢B**: [内容]
- メリット: ...
- デメリット: ...

### 推奨
[推奨案と理由]

### 必要な情報
[判断に必要な追加情報があれば]
```

## グレーゾーン判定の鉄則

以下のいずれかに該当する場合は、**問答無用でエスカレーション**:

1. **複数解釈可能**: 要件が2通り以上に読める
2. **前例なし**: 既存コードに類似パターンがない
3. **情報不足**: 判断に必要な情報が揃っていない
4. **判断分岐**: 選択によってビジネス価値が異なる

## 禁止事項

- [ ] 仕様を勝手に決定しない
- [ ] 曖昧なまま実装を進めない
- [ ] 「多分こうだろう」で判断しない
- [ ] エスカレーションを後回しにしない

## エスカレーション後のフロー

```
1. ユーザーからの回答を待つ
2. 回答を受けて実装を再開
3. 回答内容をコメントやドキュメントに記録
4. 同様の判断が必要な場面で参照できるようにする
```

## 記録の重要性

エスカレーションで得た判断は、将来の参考のために記録:

```typescript
// NOTE: [日付] 〇〇の理由でAパターンを採用
// 参考: Issue #XX または会話のコンテキスト
```
